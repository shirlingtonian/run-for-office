
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Run for Office</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-100 text-gray-900">
  <div id="root"></div>

  <script type="text/babel">
    const INITIAL_STATE = {
      popularity: 100,
      funds: 10000,
      day: 1,
      maxDays: 10,
      history: [],
      policy: {
        Economy: "Neutral",
        Environment: "Neutral",
        Education: "Neutral",
        Healthcare: "Neutral",
      },
      gameOver: false,
      message: "Welcome to Run for Office!"
    };

    function RunForOfficeGame() {
      const [state, setState] = React.useState(INITIAL_STATE);

      const log = (entry) => {
        setState((prev) => ({ ...prev, history: [...prev.history, entry] }));
      };

      const nextDay = () => {
        if (state.day >= state.maxDays) {
          endGame();
        } else {
          setState((prev) => ({ ...prev, day: prev.day + 1 }));
        }
      };

      const updateState = (popChange = 0, fundChange = 0, msg = "") => {
        setState((prev) => {
          const newPop = Math.max(0, prev.popularity + popChange);
          const newFunds = Math.max(0, prev.funds + fundChange);
          const newMsg = msg || `Day ${prev.day}: No major events.`;
          return {
            ...prev,
            popularity: newPop,
            funds: newFunds,
            message: newMsg,
            history: [...prev.history, newMsg]
          };
        });
      };

      const endGame = () => {
        const outcome =
          state.popularity >= 120 ?
            "You won the election! ðŸŽ‰" :
            "You lost the election. Better luck next time.";
        setState((prev) => ({ ...prev, gameOver: true, message: outcome }));
        log(outcome);
      };

      const actions = {
        rally: () => {
          if (state.funds < 2000) return updateState(0, 0, "Not enough funds for a rally.");
          const gain = Math.random() < 0.7 ? rand(5, 15) : -rand(5, 15);
          updateState(gain, -2000, `Held a rally. ${gain >= 0 ? "+" : ""}${gain} popularity.`);
          nextDay();
        },
        ad: () => {
          if (state.funds < 3000) return updateState(0, 0, "Not enough funds to run an ad.");
          const gain = rand(5, 20);
          updateState(gain, -3000, `Ran an ad. +${gain} popularity.`);
          nextDay();
        },
        fundraise: () => {
          const money = rand(2000, 4000);
          const loss = rand(2, 5);
          updateState(-loss, money, `Fundraised. +$${money}, -${loss} popularity.`);
          nextDay();
        },
        debate: () => {
          const gain = rand(10, 20);
          const win = Math.random() < 0.5;
          updateState(win ? gain : -gain, 0, win ? `Won the debate. +${gain} popularity.` : `Lost the debate. -${gain} popularity.`);
          nextDay();
        },
        rest: () => {
          updateState(0, 0, "You rested today. No changes.");
          nextDay();
        },
        quit: () => {
          setState((prev) => ({ ...prev, gameOver: true, message: "You quit the campaign." }));
          log("You quit the campaign.");
        }
      };

      const rand = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;

      return (
        <div className="p-4 max-w-xl mx-auto space-y-4">
          <h1 className="text-3xl font-bold">Run for Office</h1>

          <div className="bg-white p-4 rounded-xl shadow space-y-2">
            <p><strong>Day:</strong> {state.day} / {state.maxDays}</p>
            <p><strong>Popularity:</strong> {state.popularity}</p>
            <p><strong>Funds:</strong> ${state.funds}</p>
            <p className="italic">{state.message}</p>
          </div>

          {!state.gameOver && (
            <div className="grid grid-cols-2 gap-2">
              <button onClick={actions.rally} className="bg-blue-500 text-white rounded-xl p-2">Hold Rally</button>
              <button onClick={actions.ad} className="bg-green-500 text-white rounded-xl p-2">Run Ad</button>
              <button onClick={actions.fundraise} className="bg-yellow-500 text-white rounded-xl p-2">Fundraise</button>
              <button onClick={actions.debate} className="bg-purple-500 text-white rounded-xl p-2">Debate</button>
              <button onClick={actions.rest} className="bg-gray-500 text-white rounded-xl p-2">Rest</button>
              <button onClick={actions.quit} className="bg-red-600 text-white rounded-xl p-2">Quit</button>
            </div>
          )}

          <div>
            <h2 className="font-bold mt-4">Campaign History</h2>
            <ul className="text-sm list-disc pl-5">
              {state.history.map((entry, i) => <li key={i}>{entry}</li>)}
            </ul>
          </div>
        </div>
      );
    }

    ReactDOM.render(<RunForOfficeGame />, document.getElementById("root"));
  </script>
</body>
</html>
